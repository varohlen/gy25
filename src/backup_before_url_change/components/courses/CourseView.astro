---
import type { CollectionEntry } from 'astro:content';

interface Props {
  course: {
    name: string;
    code: string;
    points: number;
    description: string;
  };
  subject: CollectionEntry<'gy25-subjects'>;
  showRelatedCourses?: boolean;
}

const { course, subject, showRelatedCourses = true } = Astro.props;

// Get related courses (other courses from the same subject)
const relatedCourses = showRelatedCourses 
  ? subject.data.courses?.filter(c => c.code !== course.code) || []
  : [];
---

<div class="max-w-4xl mx-auto">
  <!-- Course Header -->
  <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
    <div class="flex items-baseline justify-between mb-6">
      <h1 class="text-3xl font-bold text-gray-900">{course.name}</h1>
      <div class="flex items-center gap-4">
        <span class="text-sm font-mono text-gray-600">{course.code}</span>
        <span class="text-sm font-medium text-gray-600">{course.points} poäng</span>
      </div>
    </div>

    <!-- Course Description -->
    <div class="prose max-w-none [&_p]:mb-4 [&_ul]:list-disc [&_ul]:pl-6 [&_ul]:mb-4 [&_li]:mb-2" set:html={course.description} />
  </div>

  <!-- Related Courses -->
  {showRelatedCourses && relatedCourses.length > 0 && (
    <div class="bg-white rounded-lg shadow-sm p-6">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Andra kurser i {subject.data.name}</h2>
      <div class="space-y-3">
        {relatedCourses.map(relatedCourse => (
          <a 
            href={`/gy25/courses/${subject.data.code.toLowerCase()}/${relatedCourse.code.toLowerCase()}`}
            class="block hover:bg-gray-50 p-3 rounded-lg transition-colors"
          >
            <div class="flex items-baseline justify-between">
              <h3 class="text-base font-medium text-gray-900">{relatedCourse.name}</h3>
              <div class="flex items-center gap-3">
                <span class="text-sm font-mono text-gray-600">{relatedCourse.code}</span>
                <span class="text-sm text-gray-600">{relatedCourse.points} poäng</span>
              </div>
            </div>
          </a>
        ))}
      </div>
    </div>
  )}
</div>
